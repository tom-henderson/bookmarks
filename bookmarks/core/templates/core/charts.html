{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="container">
    <div class="row">
        <div class="col-xs-12">
          <canvas id="myChart" style="padding-right: 30px;" width="400" height="200"></canvas>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script src="{% static "js/Chart.bundle.min.js" %}"></script>
<script language="javascript">
$(document).ready(function(){

    $.ajax({
      url:"/api/all/?format=json",
      crossDomain: false,
      dataType: "jsonp",
      success: function (data) {
        var records = data.results.collection1;

        var chartData = {
          labels: [],
          datasets: [
            {
              fillColor: "rgba(151,187,205,0.2)",
              strokeColor: "rgba(151,187,205,1)",
              pointColor: "rgba(151,187,205,1)",
              pointStrokeColor: "#fff",
              pointHighlightFill: "#fff",
              pointHighlightStroke: "rgba(151,187,205,1)",
              data: []
            },
          ]
        };

        for (var i=0; i<20; i++) {
          chartData.labels.push(records[i].date.text);
          chartData.datasets[0].data.push(parseFloat(records[i].rate));
        }
        chartData.labels.reverse();
        chartData.datasets[0].data.reverse();


        var context = $("#myChart").get(0).getContext("2d");
        var myChart = new Chart(context).Line(chartData, {
          'responsive': true,
          'maintainAspectRatio': true,
          'bezierCurve': false,
        });

      },
      error: function (xhr, status) {}
    });

});
</script>
{% endblock %}